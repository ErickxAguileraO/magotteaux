# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- Desarrollo

steps:
- script: rsync -auv --chown=magotteauxaeurus:magotteauxaeurus  --exclude='.htaccess' --exclude='CHANGELOG' --exclude='.gitlab-ci.yml' --exclude='.git' --exclude='.env' --exclude='BD' . root@209.126.108.6:/home/magotteauxaeurus/public_html/
  displayName: 'Rsync a servidor de desarrollo'

- task: SSH@0
  inputs:
    sshEndpoint: 'Desarrollo'
    runOptions: 'commands'
    commands: |
      cd /home/magotteauxaeurus/public_html/ && php artisan migrate && composer update && php artisan optimize
    readyTimeout: '20000'
